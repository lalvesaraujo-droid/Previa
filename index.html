<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prévia</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
background:linear-gradient(180deg,#1e3c72,#2a5298);
color:white;
}

.container{
max-width:420px;
margin:auto;
padding:20px;
}

.card{
background:white;
color:#1e3c72;
border-radius:18px;
padding:20px;
margin-top:20px;
}

h1{
text-align:center;
font-weight:600;
margin-top:40px;
}

label{
font-size:14px;
font-weight:600;
display:block;
margin-top:12px;
}

input,textarea,select{
width:100%;
padding:12px;
border-radius:12px;
border:none;
margin-top:6px;
background:#f1f3f6;
}

button{
width:100%;
padding:14px;
border-radius:14px;
border:1px solid rgba(255,255,255,0.4);
background:transparent;
color:white;
font-size:16px;
margin-top:16px;
}

.primary{
background:white;
color:#1e3c72;
font-weight:600;
}

.logo{
text-align:center;
font-size:26px;
font-weight:700;
letter-spacing:2px;
margin-top:10px;
}

.pdf-page{
width:794px;
min-height:1123px;
background:white;
padding:60px;
font-family:Helvetica,Arial;
color:#1e3c72;
}

.pdf-header{
text-align:center;
margin-bottom:40px;
}

.pdf-title{
font-size:26px;
font-weight:700;
margin-top:10px;
}

.pdf-section{
margin-top:20px;
}

.pdf-label{
font-weight:700;
}

.pdf-photo{
width:120px;
height:120px;
border-radius:12px;
object-fit:cover;
margin-top:20px;
}
</style>
</head>

<body>

<div class="container">

<div class="logo">PRÉVIA</div>

<h1>Nova avaliação</h1>

<div class="card">

<label>Nome do paciente</label>
<input id="nome">

<label>Idade</label>
<input id="idade">

<label>Procedimento</label>
<input id="procedimento">

<label>Tipo anestésico</label>
<select id="tipo">
<option>Geral</option>
<option>Raqui</option>
<option>Peridural</option>
<option>Bloqueio</option>
<option>Sedação</option>
</select>

<label>Comorbidades</label>
<input id="comorbidades">

<label>Medicações</label>
<input id="medicacoes">

<label>Via aérea (Mallampati)</label>
<select id="mallampati">
<option>I</option>
<option>II</option>
<option>III</option>
<option>IV</option>
</select>

<label>Condição</label>
<input id="condicao" placeholder="Apto / Pendência">

<label>Conduta</label>
<textarea id="conduta"></textarea>

<label>Foto do paciente</label>
<input type="file" id="foto" accept="image/*">

<button class="primary" onclick="gerarResumo()">Gerar resumo</button>

</div>

<div id="resumoBox" class="card" style="display:none">

<h2 style="text-align:center">Resumo anestésico</h2>

<div id="resumoTexto"></div>

<button onclick="gerarPDF()">Gerar PDF</button>

</div>

</div>

<!-- PDF HIDDEN -->
<div id="pdfArea" style="display:none"></div>

<script>

function gerarResumo(){

const nome=document.getElementById("nome").value
const idade=document.getElementById("idade").value
const procedimento=document.getElementById("procedimento").value
const tipo=document.getElementById("tipo").value
const comorbidades=document.getElementById("comorbidades").value
const medicacoes=document.getElementById("medicacoes").value
const mallampati=document.getElementById("mallampati").value
const condicao=document.getElementById("condicao").value
const conduta=document.getElementById("conduta").value

const texto=`
Paciente ${nome}, ${idade} anos.
Procedimento: ${procedimento}.
Tipo anestésico: ${tipo}.

Comorbidades: ${comorbidades}.
Medicações: ${medicacoes}.
Via aérea: Mallampati ${mallampati}.

Condição: ${condicao}.
Conduta: ${conduta}.
`

document.getElementById("resumoTexto").innerText=texto
document.getElementById("resumoBox").style.display="block"
}

function gerarPDF(){

const nome=document.getElementById("nome").value
const idade=document.getElementById("idade").value
const procedimento=document.getElementById("procedimento").value
const tipo=document.getElementById("tipo").value
const comorbidades=document.getElementById("comorbidades").value
const medicacoes=document.getElementById("medicacoes").value
const mallampati=document.getElementById("mallampati").value
const condicao=document.getElementById("condicao").value
const conduta=document.getElementById("conduta").value

const file=document.getElementById("foto").files[0]

let fotoHTML=""

if(file){
const url=URL.createObjectURL(file)
fotoHTML=`<img src="${url}" class="pdf-photo">`
}

const pdfHTML=`
<div class="pdf-page">

<div class="pdf-header">
<div style="font-size:20px;letter-spacing:3px;">PRÉVIA</div>
<div class="pdf-title">Avaliação Pré-Anestésica</div>
${fotoHTML}
</div>

<div class="pdf-section">
<span class="pdf-label">Paciente:</span> ${nome}, ${idade} anos
</div>

<div class="pdf-section">
<span class="pdf-label">Procedimento:</span> ${procedimento}
</div>

<div class="pdf-section">
<span class="pdf-label">Tipo anestésico:</span> ${tipo}
</div>

<div class="pdf-section">
<span class="pdf-label">Comorbidades:</span> ${comorbidades}
</div>

<div class="pdf-section">
<span class="pdf-label">Medicações:</span> ${medicacoes}
</div>

<div class="pdf-section">
<span class="pdf-label">Via aérea:</span> Mallampati ${mallampati}
</div>

<div class="pdf-section">
<span class="pdf-label">Condição:</span> ${condicao}
</div>

<div class="pdf-section">
<span class="pdf-label">Conduta:</span> ${conduta}
</div>

<div style="margin-top:60px;font-size:12px;color:#666">
Documento gerado pelo sistema PRÉVIA
</div>

</div>
`

document.getElementById("pdfArea").innerHTML=pdfHTML

html2pdf().from(document.getElementById("pdfArea")).save(`Previa_${nome}.pdf`)
}

</script>

</body>
</html>