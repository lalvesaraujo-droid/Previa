<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prévia</title>

<style>
body{
  margin:0;
  font-family:-apple-system, BlinkMacSystemFont;
  background:linear-gradient(180deg,#0e2a47,#153a5c);
  color:white;
}

.container{
  max-width:500px;
  margin:auto;
  padding:20px;
}

.card{
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(12px);
  border-radius:20px;
  padding:20px;
  margin-top:20px;
}

input,textarea,select{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:none;
  margin-top:8px;
  margin-bottom:16px;
  font-size:16px;
}

button{
  width:100%;
  padding:16px;
  border-radius:14px;
  border:none;
  font-size:18px;
  margin-top:12px;
}

.primary{background:#2d8cff;color:white;}
.secondary{background:rgba(255,255,255,0.2);color:white;}

h1,h2{margin:0 0 10px 0;}

.hidden{display:none;}
</style>
</head>

<body>

<div class="container">

<!-- HOME -->
<div id="home">
  <h1>Prévia</h1>
  <div class="card">
    <h2>Home</h2>
    <button class="primary" onclick="show('form')">Nova avaliação</button>
    <button class="secondary" onclick="show('historico')">Histórico</button>
  </div>
</div>

<!-- FORM -->
<div id="form" class="hidden">
  <h2>Nova avaliação</h2>

  <div class="card">
    <label>Paciente</label>
    <input id="paciente">

    <label>Idade</label>
    <input id="idade">

    <label>ASA</label>
    <select id="asa">
      <option>I</option><option>II</option><option>III</option><option>IV</option>
    </select>

    <label>Procedimento</label>
    <input id="procedimento">

    <label>Comorbidades</label>
    <textarea id="comorbidades"></textarea>

    <label>Medicações</label>
    <textarea id="medicacoes"></textarea>

    <label>Mallampati</label>
    <select id="mallampati">
      <option>I</option><option>II</option><option>III</option><option>IV</option>
    </select>

    <label>Estratégia anestésica</label>
    <textarea id="estrategia"></textarea>

    <label>Condição</label>
    <input id="condicao">

    <label>Conduta</label>
    <textarea id="conduta"></textarea>

    <button class="primary" onclick="gerarPDF()">Gerar PDF</button>
    <button class="secondary" onclick="salvar()">Salvar</button>
    <button class="secondary" onclick="show('home')">Voltar</button>
  </div>
</div>

<!-- HISTÓRICO -->
<div id="historico" class="hidden">
  <h2>Histórico</h2>
  <div id="lista"></div>
  <button class="secondary" onclick="show('home')">Voltar</button>
</div>

</div>

<script>
function show(id){
  document.querySelectorAll('#home,#form,#historico')
  .forEach(el=>el.classList.add('hidden'))
  document.getElementById(id).classList.remove('hidden')
  if(id==="historico") carregar()
}

function dados(){
return {
paciente:paciente.value,
idade:idade.value,
asa:asa.value,
procedimento:procedimento.value,
comorbidades:comorbidades.value,
medicacoes:medicacoes.value,
mallampati:mallampati.value,
estrategia:estrategia.value,
condicao:condicao.value,
conduta:conduta.value
}
}

function salvar(){
let h=JSON.parse(localStorage.previas||"[]")
h.push(dados())
localStorage.previas=JSON.stringify(h)
alert("Salvo")
}

function carregar(){
let h=JSON.parse(localStorage.previas||"[]")
lista.innerHTML=""
h.reverse().forEach(p=>{
let div=document.createElement("div")
div.className="card"
div.innerHTML="<b>"+p.paciente+"</b><br>"+p.procedimento
lista.appendChild(div)
})
}

function gerarPDF(){
let p=dados()

let w=window.open("")
w.document.write(`
<html><body style="font-family:Arial;padding:40px">
<h1>Prévia anestésica</h1>
<p><b>${p.paciente}</b>, ${p.idade} anos, ASA ${p.asa}</p>
<p><b>Procedimento:</b> ${p.procedimento}</p>
<p><b>Comorbidades:</b> ${p.comorbidades}</p>
<p><b>Medicações:</b> ${p.medicacoes}</p>
<p><b>Mallampati:</b> ${p.mallampati}</p>
<p><b>Estratégia:</b> ${p.estrategia}</p>
<p><b>Condição:</b> ${p.condicao}</p>
<p><b>Conduta:</b> ${p.conduta}</p>
</body></html>
`)
w.print()
}
</script>

</body>
</html>